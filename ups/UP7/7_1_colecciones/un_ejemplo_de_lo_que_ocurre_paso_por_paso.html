<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_highlighter.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Un ejemplo de lo que ocurre, paso por paso | 7.1. Colecciones </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Patricia Benavente" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.9 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_highlighter.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-17"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">7.1. Colecciones</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">7.1. Colecciones (interfaz Collection&lt;E&gt;)</a></li>
   <li><a href="711_listas_list.html" class="daddy">7.1.1. Listas (List)</a>
   <ul class="other-section">
      <li><a href="pilas_stack.html" class="no-ch">Pilas (Stack)</a></li>
   </ul>
   </li>
   <li><a href="712_colas_queue.html" class="daddy">7.1.2. Colas (Queue)</a>
   <ul class="other-section">
      <li><a href="clase_linkedlist.html" class="no-ch">Clase LinkedList</a></li>
   </ul>
   </li>
   <li><a href="713_conjuntos_set__sin_duplicados.html" class="daddy">7.1.3. Conjuntos (Set) - sin duplicados</a>
   <ul class="other-section">
      <li><a href="clase_hashset.html" class="no-ch">Clase HashSet</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="714_mtodos_equals_y_hashcode_de_un_objeto.html" class="current-page-parent daddy">7.1.4. Métodos equals() y hashCode() de un objeto</a>
   <ul>
      <li id="active"><a href="un_ejemplo_de_lo_que_ocurre_paso_por_paso.html" class="active no-ch">Un ejemplo de lo que ocurre, paso por paso</a></li>
   </ul>
   </li>
   <li><a href="ejercicios_de_colecciones_haciendo_uso_de_objetos.html" class="no-ch">Ejercicios de colecciones haciendo uso de objetos</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="714_mtodos_equals_y_hashcode_de_un_objeto.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="ejercicios_de_colecciones_haciendo_uso_de_objetos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">Un ejemplo de lo que ocurre, paso por paso</h1></header>
<article class="iDevice_wrapper textIdevice" id="id32">
<div class="iDevice emphasis0" >
<div id="ta32_127_2" class="block iDevice_content">
<div class="exe-text"><p>Vamos a suponer que tenemos la siguiente clase <em><strong>Estudiante</strong></em>, con la siguiente estructura:</p>
<div class="highlighted-code code-style-2 language-java line-numbers">
<div>
<pre><code>public class Estudiante {
    
    private String nia;
    private String nombre;
    private String apellidos;
    
    public Estudiante (String nia, String nombre, String apellidos){
        this.nia = nia;
        this.nombre=nombre;
        this.apellidos=apellidos;
    }
    
}</code></pre>
</div>
</div>
<p>Nos vamos al <em>main</em> y creamos una instancia de nuestra clase. Observa que <em>Java</em> nos permite usar los métodos <em>.equals()</em> y <em>hashCode()</em>:</p>
<div class="highlighted-code code-style-2 language-java line-numbers">
<div>
<pre><code>public class Main {

    public static void main(String[] args) {

        Estudiante estudiante1 =  new Estudiante("12345667","Carlos","Pérez Sánchez");

        estudiante1.equals();
        estudiante1.hashCode();

    }
}</code></pre>
</div>
</div>
<p>El método <em>hashCode</em> devolverá un número entero que identificará a nuestro estudiante según la implementación de este en la clase <em>Object:</em></p>
<p><em><img src="img1.7.png" width="788" height="254" alt="2" style="display: block; margin-left: auto; margin-right: auto;" /></em></p>
<p><em><img src="img0.14.png" width="991" height="385" alt="1" /></em></p>
<p>pero es recomendable que nosotros implementemos nuestra propia versión sobreescribiéndolo.</p>
<p>Podríamos hacerlo a mano, teniendo en cuenta que se debe devolver un valor numérico. Por ejemplo,</p>
<p><img src="img2.2.png" width="299" height="142" alt="3" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p>Pero dado que nos interesa que ese valor numérico sea lo más único posible para identificar bien a nuestros objetos, haremos uso del generador del <em>IDE IntelliJ. </em><span style="background-color: #ffff99;"><strong>No se recomienda hacerlo manualmente</strong></span><em>.</em></p>
<p><em><img src="img3.3.png" width="673" height="440" alt="3" style="display: block; margin-left: auto; margin-right: auto;" /></em></p>
<p><em><img src="img4.2.png" width="435" height="274" alt="4" style="display: block; margin-left: auto; margin-right: auto;" /></em></p>
<p><em><img src="img5.png" width="433" height="269" alt="4" style="display: block; margin-left: auto; margin-right: auto;" /></em></p>
<p><em><img src="img6.png" width="434" height="272" alt="5" style="display: block; margin-left: auto; margin-right: auto;" /></em></p>
<p style="padding-left: 30px;">Lo que obtenemos es el siguiente código:</p>
<div class="highlighted-code code-style-2 language-java line-numbers">
<div>
<pre><code>public class Estudiante {

    private String nia;
    private String nombre;
    private String apellidos;

    public Estudiante (String nia, String nombre, String apellidos){
        this.nia = nia;
        this.nombre=nombre;
        this.apellidos=apellidos;
    }

//    @Override
//    public boolean equals(Object o) {
//        if (this == o) return true;
//        if (o == null || getClass() != o.getClass()) return false;
//        Estudiante that = (Estudiante) o;
//        return Objects.equals(nia, that.nia) &amp;&amp; Objects.equals(nombre, that.nombre) &amp;&amp; Objects.equals(apellidos, that.apellidos);
//    }

    @Override
    public int hashCode() {
        return Objects.hash(nia, nombre, apellidos);
    }

}
</code></pre>
</div>
</div>
<p>Comentamos de momento el <em><strong>equals()</strong> </em>generado. La recomendación que nos hace <em>IntelliJ</em> para el método <em>hashCode()</em> es la siguiente:</p>
<p style="padding-left: 30px;">- Se mira si cada uno de sus atributos es nulo (o no),</p>
<p><img src="img7.png" width="810" height="345" alt="6" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px;">y seguidamente llama a un método que utiliza un multiplicador para dar valor al <em>hash</em> teniendo en cuenta los atributos de la clase. En este caso, el <em><strong>31</strong></em>:</p>
<p><img src="img8.png" width="884" height="388" alt="7" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px;">Para probarlo, vamos a crear otro estudiante con las mismas propiedades al que teníamos anteriormente. El resultado del <em>hash</em> debería ser igual entre ellos:</p>
<p style="padding-left: 30px;"><img src="img9.png" width="961" height="413" alt="7" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px; text-align: justify;">Ahora que ya controlamos que nuestros objetos obtengan el mismo <em>hash</em>, para terminar de identificar si son iguales deberemos sobreescribir el método <em>equals</em> para que no solamente se compruebe la referencia en memoria, sino también los valores de los atributos. Antes de recuperar el método que nos ha creado <em>IntelliJ</em>, vamos a hacer la siguiente prueba.</p>
<p style="padding-left: 30px;">Vamos a añadir a nuestro <em>main</em> una condición para preguntar si nuestros objetos son iguales:</p>
<p style="padding-left: 30px;"><img src="img10.png" width="961" height="472" alt="9" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px; text-align: justify;">Fíjate que a pesar de ser aparentemente iguales, la condición no se cumple y no obtenemos la respuesta esperada. Esto se debe a que, aunque el <em>hash</em> ya es el mismo, el método <em>equals</em> por defecto sigue mirando solamente la referencia en memoria. En este caso, como nuestros objetos tendrán una dirección de memoria distinta (referenciados como <em>estudiante1</em> y <em>estudiante2</em>), la condición no se cumplirá.</p>
<p style="padding-left: 30px; text-align: justify;">Para que el método <em>equals</em> compruebe también el valor de los atributos, vamos a descomentar las líneas generadas por <em>IntelliJ</em> para sobreescribirlo:</p>
<div class="highlighted-code code-style-2 language-java line-numbers">
<div>
<pre><code>package org.example.hash_equals;

import java.util.Objects;

public class Estudiante {

    private String nia;
    private String nombre;
    private String apellidos;

    public Estudiante(String nia, String nombre, String apellidos) {
        this.nia = nia;
        this.nombre = nombre;
        this.apellidos = apellidos;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Estudiante that = (Estudiante) o;
        return Objects.equals(nia, that.nia) &amp;&amp; Objects.equals(nombre, that.nombre) &amp;&amp; Objects.equals(apellidos, that.apellidos);
    }

    @Override
    public int hashCode() {
        return Objects.hash(nia, nombre, apellidos);
    }

}
</code></pre>
</div>
</div>
<p style="padding-left: 30px; text-align: justify;">En este caso, la primera condición que va a mirar <em>equals</em> es igualmente si el objeto que hemos pasado apunta a la misma dirección de memoria que el actual. Después, mira si la clase es la misma (o no) con la instancia actual y el objeto que hemos pasado por parámetro. <span style="background-color: #ffff99;"><strong>Y además, ahora también comprueba que los atributos de cada uno de los objetos comparados también sean iguales</strong></span>.</p>
<p style="padding-left: 30px;">Si ahora volvemos a lanzar nuestro programa, </p>
<p style="padding-left: 30px;"><img src="img11.png" width="961" height="421" alt="9" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px; text-align: justify;"><em>Java</em> ya detecta que se trata del mismo objeto, ya que además de la dirección de memoria, comprueba los valores de los atributos.</p>
<hr />
<h5>Modificar implementación de <em>equals()</em> para que solamente se tenga en cuenta ciertos atributos</h5>
<p style="text-align: justify;">Es posible que necesitemos considerar que dos objetos son iguales en función de alguno de los atributos, y no por todos. En el ejemplo anterior, podríamos establecer el <em><strong>nia</strong></em> para considerar si dos estudiantes son iguales o no, ya que podrían tener el mismo nombre y apellidos.</p>
<p style="text-align: justify;">Para adaptar el método <em>equals</em> a nuestras necesidades, podremos modificarlo a mano siempre que sea necesario. En este caso, vamos a eliminar la condición que mira si el nombre y los apellidos también son iguales, y dejaremos solamente la condición del <strong><em>nia</em></strong>.</p>
<div class="highlighted-code code-style-2 language-java line-numbers">
<div>
<pre><code>    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Estudiante that = (Estudiante) o;
        return Objects.equals(nia, that.nia);
    }</code></pre>
</div>
</div>
<p style="text-align: justify;">De esta forma, solamente se considerará a dos estudiantes iguales si el <em><strong>nia</strong> </em>que se ha guardado es el mismo. </p>
<p><img src="img13.png" width="991" height="426" alt="11" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p><img src="img12.png" width="991" height="447" alt="10" style="display: block; margin-left: auto; margin-right: auto;" /></p>
<p style="padding-left: 30px;"><strong><span style="background-color: #ffff99;"><span style="text-decoration: underline;"><span style="color: #ff0000; text-decoration: underline;">OJO</span></span><span style="color: #ff0000;"> </span>porque ahora el valor <em>hash</em> no será el mismo. Por eso, <span style="text-decoration: underline;">es importante que los dos métodos estén implementados juntos</span>.</span></strong></p></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="714_mtodos_equals_y_hashcode_de_un_objeto.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="ejercicios_de_colecciones_haciendo_uso_de_objetos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Creado con eXeLearning<span> (Ventana nueva)</span></span></a></p><script type="text/javascript" src="_style_js.js"></script></body></html>